!function(a){"use strict";a.fn=a.fn||{datagen:{}}}(this),function(a){"use strict";var b=2;a.fn.datagen.almostSorted=function(c){var d,e,f=a.fn.datagen.sorted(c),g=[],h=f.length;for(e=0;h>e;e++)d=a.fn.random(e,Math.min(e+b,h-1)),g.indexOf(e)<0&&g.indexOf(d)<0&&(g.push(e),g.push(d),a.fn.swap(f,e,d));return f}}(this),function(a){"use strict";var b=4;a.fn.datagen.fewUnique=function(c){var d,e=[];for(d=0;c>d;d++)e.push(c-1-Math.floor(c/b)*(d%b));return a.fn.shuffle(e)}}(this),function(a){"use strict";a.fn.datagen.randomDupes=function(a){var b,c=[];for(b=0;a>b;b++)c.push(Math.floor(Math.random()*a));return c}}(this),function(a){"use strict";a.fn.datagen.randomUnique=function(b){return a.fn.shuffle(a.fn.datagen.sorted(b))}}(this),function(a){"use strict";a.fn.datagen.reverse=function(b){return a.fn.datagen.sorted(b).reverse()}}(this),function(a){"use strict";a.fn.datagen.sorted=function(a){var b,c=[];for(b=0;a>b;b++)c.push(b);return c}}(this),function(a){"use strict";a.fn.random=function(a,b){return Math.floor(Math.random()*(b-a+1))+a}}(this),function(a){"use strict";a.fn.shuffle=function(b){var c,d=b.length;if(0===d)return b;for(;--d;)c=Math.floor(Math.random()*(d+1)),b=a.fn.swap(b,d,c);return b}}(this),function(a){"use strict";a.fn.swap=function(a,b,c){var d,e,f=a.length;return b=parseInt(b,10)||0,c=parseInt(c,10)||0,b!==c&&b>=0&&c>=0&&f>b&&f>c&&(d=a[b],e=a[c],a[b]=e,a[c]=d),a}}(this),function(a){"use strict";a.sort=a.sort||{}}(this),function(a){"use strict";a.sort.bubble=function(){var a,b,c=AS.length();do{for(b=!1,a=0;c-1>a;a++)AS.play(a),AS.mark(a),AS.lt(a+1,a)&&(AS.swap(a+1,a),b=!0),AS.next();c--}while(b);AS.play(a)},a.sort.bubble.display="Bubble",a.sort.bubble.stable=!0,a.sort.bubble.best="n",a.sort.bubble.average="n^2",a.sort.bubble.worst="n^2",a.sort.bubble.memory="1",a.sort.bubble.method="exchanging"}(this),function(a){"use strict";a.sort.insertion=function(){var a,b,c,d,e=AS.length();for(a=0;e>a;a++){for(c=AS.get(a),b=a-1;b>-1;b--)d=AS.get(b),AS.play(b),AS.gt(b,a),d>c&&AS.swap(b,b+1),AS.next();AS.next()}},a.sort.insertion.display="Insertion",a.sort.insertion.stable=!0,a.sort.insertion.best="n",a.sort.insertion.average="n^2",a.sort.insertion.worst="n^2",a.sort.insertion.memory="1",a.sort.insertion.method="insertion"}(this),function(a){"use strict";a.sort.quick=function(){var a,b;a=function(a,b){for(var c=Math.floor((b+a)/2),d=AS.get(c),e=a,f=b;f>=e;){for(;AS.get(e)<d;)AS.play(e,f),AS.mark(e,f),AS.markTwo(c),AS.next(),e++;for(;AS.get(f)>d;)AS.play(e,f),AS.mark(e,f),AS.markTwo(c),AS.next(),f--;f>=e&&(AS.play(e,f),AS.mark(e,f),AS.markTwo(c),AS.swap(e,f),AS.next(),e++,f--)}return e},b=function(c,d){var e,f=AS.length();f>1&&(c="number"!=typeof c?0:c,d="number"!=typeof d?f-1:d,AS.mark(c,d),e=a(c,d),e-1>c&&b(c,e-1),d>e&&b(e,d))},b()},a.sort.quick.display="Quick",a.sort.quick.stable=!0,a.sort.quick.best="n",a.sort.quick.average="n^2",a.sort.quick.worst="n^2",a.sort.quick.memory="1",a.sort.quick.method="exchanging"}(this),function(a){"use strict";a.sort.selection=function(){var a,b,c,d=AS.length();for(b=0;d>b;b++){for(a=b,c=b+1;d>c;c++)AS.play(c),AS.mark(b,c),AS.lt(c,a)&&(a=c),AS.next();b!==a&&AS.swap(b,a)}AS.next()},a.sort.selection.display="Selection",a.sort.selection.stable=!1,a.sort.selection.best="n^2",a.sort.selection.average="n^2",a.sort.selection.worst="n^2",a.sort.selection.memory="1",a.sort.selection.method="selection"}(this),function(a){"use strict";var b,c,d,e,f,g={},h=[],i=[],j=!0,k=0,l=0;d=function(a){var b,c="object"==typeof a;return b={value:c?a.value:a,play:c?a.play:!1,swap:c?a.swap:!1,compare:c?a.compare:!1,mark:c?a.mark:!1,markTwo:c?a.markTwo:!1}},e=function(){j&&b(),j=!1},b=function(){var a,b=[];for(a=0;a<h.length;a++)b.push(d(h[a]));i.push({arr:b,compareCount:k,swapCount:l})},c=function(a,b){f("compare",a),f("compare",b),k++,i[i.length-1].compareCount=k},f=function(a,b){var c,d;e(),c=i.length-1,d=i[c].arr.length,b>=0&&d>b&&(i[c].arr[b][a]=!0)},g.getFrames=function(){return i},g.init=function(a){var b;for(h=[],i=[],j=!0,k=0,l=0,b=0;b<a.length;b++)h.push(d(a[b]))},g.length=function(){return h.length},g.size=g.length,g.lt=function(a,b){return c(a,b),g.get(a)<g.get(b)},g.lte=function(a,b){return c(a,b),g.get(a)<=g.get(b)},g.gt=function(a,b){return c(a,b),g.get(a)>g.get(b)},g.gte=function(a,b){return c(a,b),g.get(a)>=g.get(b)},g.eq=function(a,b){return c(a,b),g.get(a)===g.get(b)},g.neq=function(a,b){return c(a,b),g.get(a)!==g.get(b)},g.play=function(){var a;for(a=0;a<arguments.length;a++)f("play",arguments[a])},g.mark=function(){var a;for(a=0;a<arguments.length;a++)f("mark",arguments[a])},g.markTwo=function(){var a;for(a=0;a<arguments.length;a++)f("markTwo",arguments[a])},g.get=function(a){return h[a].value},g.swap=function(a,b){var c,d;f("swap",a),f("swap",b),c=h[a],d=h[b],h[a]=d,h[b]=c,l++,i[i.length-1].swapCount=l,j=!0},g.next=function(){b(),j=!1},a.AS=g}(this),function(a){"use strict";a.AudioPlayer={},a.AudioPlayer.create=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B={};return q=function(){if(b=b||{},!b.hasOwnProperty("env")||!b.hasOwnProperty("pluck"))throw new Error('Invalid "env" or "pluck" passed to AudioPlayer.create(options)');o=b.env,p=b.pluck,c=b.isLooping||!1,d=b.isPlaying||!1,e=b.isReverse||!1,g=b.hasMarkers||!1,f=0,h=$(a||null),i=h.find(".position-count"),j=h.find(".swap-count"),l=d3.select("#"+h.find("svg").attr("id")),z=b.onPlayerButtonClickCallback||null,n=timbre("interval",{interval:AudioSort.getSelected("tempo")},u),h.find(".player-buttons").on("click",".btn",y)},r=function(a,b,c){var d,e,f,h;g&&(d=l.selectAll("circle."+c).data(a.arr),e=a.arr.length,d.enter().append("circle"),f=100/(4*Math.max(e,20)),h=100-10*b+"%",d.attr("cy",h).attr("cx",function(a,b){var c=100/(2*e);return 100*(b/e)+c+"%"}).attr("r",function(){return f+"%"}).attr("class",c).attr("style",function(a){return a[c]?"":"display:none"}),d.exit().remove())},s=function(){var a,b,c;t(),m.length>0&&(a=m[f],b=l.selectAll("rect").data(a.arr),c=a.arr.length,b.enter().append("rect"),b.attr("width",function(){return 100/c+"%"}).attr("height",function(a){return 100/c*(a.value+1)+"%"}).attr("x",function(a,b){return 100*(b/c)+"%"}).attr("y",function(a){return 100-100/c*(a.value+1)+"%"}).attr("class",function(a){return a.play?"play":""}),b.exit().remove(),r(a,1,"markTwo"),r(a,3,"swap"),r(a,4,"compare"),r(a,5,"mark"),i.text(parseInt(f+1,10)+" / "+m.length),j.length&&j.text("c:"+a.compareCount+" / s:"+a.swapCount))},t=function(){f=Math.min(f,m.length-1),f=Math.max(f,0)},v=function(a){var b,c,d,e,f,g,h;return b=sc.ScaleInfo.at(AudioSort.getSelected("scale")),c=b.pitchesPerOctave(),d=b.degrees(),e=d.length,f=Math.floor(AudioSort.getSelected("dataSize")/2),g=w(d,e,c,a),h=w(d,e,c,f),g+AudioSort.getSelected("centerNote")-h},w=function(a,b,c,d){return a[d%b]+Math.floor(d/b)*c},x=function(a){var b=[];return a.indices.length&&b.push(a.indices[0]),b},u=function(){var a,b,g,h;if(d){if(t(),k.length&&k.slider("setValue",f),m.length>0){for(b=m[f],g=0;g<b.arr.length;g++)h=b.arr[g],h.play&&(a=v(h.value),a>=0&&128>a&&p.noteOn(a,64));s()}f=e?f-1:f+1,!c&&(0>f||f>=m.length)&&B.stop(),c&&0>f?f=m.length-1:c&&f>=m.length&&(f=0)}else B.stop()},y=function(){var a=$(this),b=a.data("action");"stop"===b?B.stop():"play"===b?B.play():"reverse"===b?B.play(!0):"loop"===b&&(c=!a.hasClass("active"),c?a.addClass("active"):a.removeClass("active")),"function"==typeof z&&z({item:a,action:b})},A=function(a){f=parseInt(a.value,10),t(),s()},B.setData=function(b){var c=a+" .position-container";m=b,k=AudioSort.createSlider(c,{value:0,min:0,max:m.length-1,step:1},A),s()},B.setTempo=function(a){n.set({interval:a})},B.play=function(a){n.stop(),d=!0,a===!0?(e=!0,f=m.length-1):(e=!1,f=0),e=a===!0?!0:!1,n.start()},B.stop=function(){d=!1,n.stop()},B.isPlaying=function(){return d},B.goToFirst=function(){e=!1,f=0,t(),s()},B.goToLast=function(){e=!1,f=m.length-1,t(),s()},B.goToIndex=function(a){e=!1,f=a,t(),s()},q(),B}}(this),function(a){"use strict";var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E={},F=Function,G={volume:{value:.25,min:0,max:1,step:.01},tempo:{value:120,min:20,max:300,step:1},centerNote:{value:69,min:0,max:127,step:1},scale:{value:"chromatic"},sort:{value:"bubble"},dataSize:{value:25,min:4,max:48,step:1}},H={volume:G.volume.value,tempo:G.tempo.value,centerNote:G.centerNote.value,scale:G.scale.value,sort:G.sort.value,dataSize:G.dataSize.value},I={base:null,sort:null},J={},K=[],L=[],M=!1,N=null,O="dist/worker.min.js";i=function(b){var c,d,e,f,g;if(a.hasOwnProperty("sort")){c=$(b),c.empty();for(f in a.sort)a.sort.hasOwnProperty(f)&&(g=a.sort[f],d=$("<li></li>"),e=$('<a href="javascript:void(0);"></a>'),e.attr("data-sort",f),e.text(g.display),d.append(e),c.append(d))}},m=function(a){var b,c=[];for(b=0;b<K.length;b++)c.push({value:K[b],play:b===a,swap:!1,compare:!1,mark:!1,markTwo:!1});return c},l=function(){var a,b=[];for(a=0;a<K.length;a++)b.push({arr:m(a),compareCount:0,swapCount:0});return b},j=function(){$('#sort-player .btn[data-action="play"]').click()},n=function(a){var b=["c","c#","d","d#","e","f","f#","g","g#","a","a#","b"],c=b.length,d=Math.floor(a/c)-1,e=a%c,f=b[e];return"("+f.charAt(0)+d+f.charAt(1)+") "+a},D=function(a,b,c){J.hasOwnProperty(a)||(J[a]=$(a)),"function"==typeof c&&(b=c(b)),J[a].text(b)},s=function(a,b,c,d){c&&(H[a]=c.value),D(b,H[a],d)},w=function(a){s("volume","#volume-display",a,function(a){return a.toFixed(2)}),c.set({mul:H.volume})},v=function(a){var b=p();s("tempo","#tempo-display",a),I.base.setTempo(b),I.sort.setTempo(b)},t=function(a){s("centerNote","#center-note-display",a,n)},u=function(a){s("dataSize","#data-size-display",a),K=L.slice(0,H.dataSize),I.base.setData(l()),k(!0,!1)},r=function(a){H.scale=a.target.value},q=function(){var b=$(this).data("action");a.fn.datagen.hasOwnProperty(b)&&(K=a.fn.datagen[b](H.dataSize),I.base.setData(l()),I.base.goToFirst(),I.base.isPlaying()&&I.base.play(),k(!0,!1))},x=function(){var a=$(this),b=a.parent();a.hasClass("disabled")||(b.find("li").removeClass("active"),a.addClass("active"),D("#sort-display",a.text()),H.sort=a.find("a").data("sort"),k(!0,M))},f=function(a){var b=$(a),c="id_"+(new Date).getTime();b.empty().append('<div class="js-editor" id="'+c+'"></div>'),d=ace.edit(c),d.setTheme("ace/theme/monokai"),d.getSession().setMode("ace/mode/javascript")},y=function(){var b,c=$("#sort-modal"),e=a.sort[H.sort];c.find(".sort-name").text(e.display),c.find(".nav-tabs a:first").tab("show"),c.find("#sort-info-display").html(e.display||"&nbsp;"),c.find("#sort-info-stable").html(e.stable?"Yes":"No"),c.find("#sort-info-best").html(e.best||"&nbsp;"),c.find("#sort-info-average").html(e.average||"&nbsp;"),c.find("#sort-info-worst").html(e.worst||"&nbsp;"),c.find("#sort-info-memory").html(e.memory||"&nbsp;"),c.find("#sort-info-method").html(e.method||"&nbsp;"),f("#sort-algorithm"),b=$.trim(e.toString()).split("\n"),d.setValue(b.splice(1,b.length-2).join("\n")),d.clearSelection(),c.modal()},g=function(){a.sort[H.sort]=new F(d.getValue()),$("#sort-modal").modal("hide")},h=function(){var b=$("#new-sort-name").val(),c=b.replace(/[^a-zA-Z]/gi,""),e=c+"_id_"+(new Date).getTime();a.sort[e]=new F(d.getValue()),a.sort[e].display=b,a.sort[e].stable=!0,a.sort[e].best="",a.sort[e].average="",a.sort[e].worst="",a.sort[e].memory="",a.sort[e].method="",$("#add-algorithm-modal").modal("hide"),i("#sort-options")},z=function(){var a=$("#add-algorithm-modal");a.find("#new-sort-name").val(""),f("#new-sort-algorithm"),a.modal()},p=function(){return"bpm"+(parseFloat(H.tempo)||120)+" l16"},B=function(){b=timbre("perc",{a:50,r:2500}),c=timbre("PluckGen",{env:b,mul:H.volume,poly:10}).play()},C=function(){I.base=AudioPlayer.create("#base-section",{env:b,pluck:c,isLooping:!0,hasMarkers:!1,onPlayerButtonClickCallback:function(a){"loop"!==a.action&&I.sort.stop()}}),I.sort=AudioPlayer.create("#sort-section",{env:b,pluck:c,isLooping:!1,hasMarkers:!0,onPlayerButtonClickCallback:function(a){"loop"!==a.action&&I.base.stop()}})},o=function(){var a=sc.ScaleInfo.names().sort(function(a,b){var c=0,d=sc.ScaleInfo.at(a),e=sc.ScaleInfo.at(b);return c=d.pitchesPerOctave()-e.pitchesPerOctave(),0===c&&(c=d.degrees().length-e.degrees().length,0===c&&(c=d.name.localeCompare(e.name))),c});return a},A=function(a,b,c){var d,e,f,g,h,i,j,k,l;j=$(a),g=o(),$.each(g,function(a,b){f=sc.ScaleInfo.at(b),h=f.pitchesPerOctave(),i=f.degrees().length,d=h+"_"+i,d!==e&&(e&&j.append(k),e=d,k=$("<optgroup />").attr("label","Octave: "+h+" / Notes: "+i)),l=$("<option />").val(b).text(f.name),H.scale===b&&l.attr("selected","selected"),k.append(l)}),j.append(k),$(a).chosen().change(c),$(b).width("100%")},k=function(b,c){"undefined"!=typeof Worker&&(null!==N&&N.terminate(),e=(new Date).getTime(),N=new Worker(O),N.addEventListener("message",function(a){var d=I.sort.isPlaying();a.data.key===e&&(I.sort.setData(a.data.frames||[]),(d||b)&&I.sort.goToFirst(),(d||c)&&j())},!1),N.postMessage({key:e,fn:a.sort[H.sort].toString(),arr:K}))},E.createSlider=function(a,b,c){var d,e=$(a),f=$('<div class="audio-sort-slider"></div>');return e.empty(),f.appendTo(e),d=f.slider({value:b.value,min:b.min,max:b.max,step:b.step,orientation:"horizontal",selection:"none",tooltip:"hide"}),d.on("slide",c),d.on("slideStop",c),$(a+" .slider").width("100%"),d},E.getSelected=function(a,b){return H.hasOwnProperty(a)?H[a]:b},E.init=function(b){"string"==typeof b&&(O=b),i("#sort-options"),B(),C(),K=a.fn.datagen.randomUnique(H.dataSize),L=a.fn.datagen.sorted(G.dataSize.max),I.base.setData(l()),A("#scale-select","#scale_select_chzn",r),E.createSlider("#volume-container",G.volume,w),E.createSlider("#tempo-container",G.tempo,v),E.createSlider("#center-note-container",G.centerNote,t),E.createSlider("#data-size-container",G.dataSize,u),$("#sort-modal-open").on("click",y),$("#add-algorithm-btn").on("click",z),$("#save-algorithm-edit").on("click",g),$("#save-algorithm-new").on("click",h),$("#base-buttons").on("click",".btn",q),$("#sort-options").on("click","li",x),$("#sort-options [data-sort="+H.sort+"]").click(),M=!0,D("#volume-display",H.volume),D("#tempo-display",H.tempo),D("#center-note-display",H.centerNote,n),D("#data-size-display",H.dataSize)},a.AudioSort=E}(this);