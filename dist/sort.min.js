!function(a){"use strict";a.fn=a.fn||{datagen:{}}}(this),function(a){"use strict";var b=2;a.fn.datagen.almostSorted=function(c){var d,e,f=a.fn.datagen.sorted(c),g=[],h=f.length;for(e=0;h>e;e++)d=a.fn.random(e,Math.min(e+b,h-1)),g.indexOf(e)<0&&g.indexOf(d)<0&&(g.push(e),g.push(d),a.fn.swap(f,e,d));return f}}(this),function(a){"use strict";var b=4;a.fn.datagen.fewUnique=function(c){var d,e=[];for(d=0;c>d;d++)e.push(c-1-Math.floor(c/b)*(d%b));return a.fn.shuffle(e)}}(this),function(a){"use strict";a.fn.datagen.randomDupes=function(a){var b,c=[];for(b=0;a>b;b++)c.push(Math.floor(Math.random()*a));return c}}(this),function(a){"use strict";a.fn.datagen.randomUnique=function(b){return a.fn.shuffle(a.fn.datagen.sorted(b))}}(this),function(a){"use strict";a.fn.datagen.reverse=function(b){return a.fn.datagen.sorted(b).reverse()}}(this),function(a){"use strict";a.fn.datagen.sorted=function(a){var b,c=[];for(b=0;a>b;b++)c.push(b);return c}}(this),function(a){"use strict";a.fn.random=function(a,b){return Math.floor(Math.random()*(b-a+1))+a}}(this),function(a){"use strict";a.fn.shuffle=function(b){var c,d=b.length;if(0===d)return b;for(;--d;)c=Math.floor(Math.random()*(d+1)),b=a.fn.swap(b,d,c);return b}}(this),function(a){"use strict";a.fn.swap=function(a,b,c){var d,e,f=a.length;return b=parseInt(b,10)||0,c=parseInt(c,10)||0,b!==c&&b>=0&&c>=0&&f>b&&f>c&&(d=a[b],e=a[c],a[b]=e,a[c]=d),a}}(this),function(a){"use strict";a.sort=a.sort||{}}(this),function(a){"use strict";a.sort.bubble=function(){var a,b,c=AS.length();do{for(b=!1,a=0;c-1>a;a++)AS.play(a),AS.mark(a),AS.lt(a+1,a)&&(AS.swap(a+1,a),b=!0);c--}while(b);AS.play(a)},a.sort.bubble.display="Bubble",a.sort.bubble.stable=!0,a.sort.bubble.best="n",a.sort.bubble.average="n^2",a.sort.bubble.worst="n^2",a.sort.bubble.memory="1",a.sort.bubble.method="exchanging"}(this),function(a){"use strict";a.sort.insertion=function(){var a,b,c,d,e=AS.length();for(a=0;e>a;a++)for(c=AS.get(a),b=a-1;b>-1;b--)d=AS.get(b),AS.play(b),AS.gt(d,c)&&AS.swap(b,b+1)},a.sort.insertion.display="Insertion",a.sort.insertion.stable=!0,a.sort.insertion.best="n",a.sort.insertion.average="n^2",a.sort.insertion.worst="n^2",a.sort.insertion.memory="1",a.sort.insertion.method="insertion"}(this),function(a){"use strict";a.sort.quick=function(){var a,b;a=function(a,b){var c=Math.floor((b+a)/2),d=AS.get(c),e=a,f=b;for(AS.clearHighlight(),AS.play(e,f),AS.mark(e,f),AS.highlight(e,f,c);f>=e;){for(;AS.lt(AS.get(e),d);)AS.play(e,f),AS.mark(e,f),e++;for(;AS.gt(AS.get(f),d);)AS.play(e,f),AS.mark(e,f),f--;f>=e&&(AS.play(e,f),AS.mark(e,f),AS.swap(e,f),e++,f--)}return AS.clearHighlight(),e},b=function(c,d){var e,f=AS.length();f>1&&(c="number"!=typeof c?0:c,d="number"!=typeof d?f-1:d,AS.mark(c,d),e=a(c,d),e-1>c&&b(c,e-1),d>e&&b(e,d))},b()},a.sort.quick.display="Quick",a.sort.quick.stable=!0,a.sort.quick.best="n",a.sort.quick.average="n^2",a.sort.quick.worst="n^2",a.sort.quick.memory="1",a.sort.quick.method="exchanging"}(this),function(a){"use strict";a.sort.selection=function(){var a,b,c,d=AS.length();for(b=0;d>b;b++){for(a=b,c=b+1;d>c;c++)AS.play(c),AS.mark(b,c),AS.lt(c,a)&&(a=c);b!==a&&AS.swap(b,a)}},a.sort.selection.display="Selection",a.sort.selection.stable=!1,a.sort.selection.best="n^2",a.sort.selection.average="n^2",a.sort.selection.worst="n^2",a.sort.selection.memory="1",a.sort.selection.method="selection"}(this),function(a){"use strict";a.viz=a.viz||{}}(this),function(a){"use strict";var b,c,d,e={};d=function(a,d,e){var f,g,h,i;c&&(f=b.selectAll("circle."+e).data(a.arr),g=a.arr.length,f.enter().append("circle"),h=100/(4*Math.max(g,20)),i=100-10*d+"%",f.attr("cy",i).attr("cx",function(a,b){var c=100/(2*g);return 100*(b/g)+c+"%"}).attr("r",function(){return h+"%"}).attr("class",e).attr("style",function(a){return a[e]?"":"display:none"}),f.exit().remove())},e.init=function(a){b=a.svg,c=a.hasMarkers},e.draw=function(a,c){var e,f,g;return a.length>0&&(e=a[c],f=b.selectAll("rect").data(e.arr),g=e.arr.length,f.enter().append("rect"),f.attr("width",function(){return 100/g+"%"}).attr("height",function(a){return 100/g*(a.value+1)+"%"}).attr("x",function(a,b){return 100*(b/g)+"%"}).attr("y",function(a){return 100-100/g*(a.value+1)+"%"}).attr("class",function(a){return a.play?"play":""}),f.exit().remove(),d(e,1,"highlight"),d(e,2,"justSwapped"),d(e,3,"swap"),d(e,4,"compare"),d(e,5,"mark")),e},a.viz.bar=e}(this),function(a){"use strict";var b,c,d,e,f,g,h,i={},j=[],k=[],l="",m={play:[],mark:[],swap:[],compare:[],highlight:[]},n=0,o=0;d=function(a){var b,c="object"==typeof a,d=parseInt(1e7*Math.random(),10);return b={id:c?a.id:d+"_"+a,value:c?a.value:a,play:c?a.play:!1,mark:c?a.mark:!1,swap:c?a.swap:!1,justSwapped:c?a.justSwapped:!1,compare:c?a.compare:!1,highlight:c?a.highlight:!1}},e=function(a){(0===k.length||m.hasOwnProperty(a)&&m[a].length)&&b()},b=function(){var a,b,c=[];for(a=0;a<j.length;a++)b=d(j[a]),m.swap.indexOf(b.id)>=0&&(b.justSwapped=!0),m.highlight.indexOf(b.id)>=0&&(b.highlight=!0),c.push(b);k.push({arr:c,compareCount:n,swapCount:o}),m.play=[],m.mark=[],m.swap=[],m.compare=[]},f=function(a){var b;for(b=0;b<j.length;b++)if(j[b].id===a.id)return b;return-1},g=function(a){var b,c,d=[];for(b=0;b<a.length;b++)c=a[b],"number"==typeof c&&(c=i.get(c)),d.push(c);return d},c=function(a,b){var c=h("compare",[a,b]);return n++,k[k.length-1].compareCount=n,c},h=function(a,b){var c,d,h,i,j=g(b);for(e(a),c=k.length-1,d=k[c].arr.length,h=0;h<j.length;h++)i=f(j[h]),i>=0&&d>i&&(k[c].arr[i][a]=!0,m.hasOwnProperty(a)&&m[a].push(k[c].arr[i].id));return j},i.getFrames=function(){return k},i.init=function(a,b){var c;for(j=[],k=[],l=b,n=0,o=0,c=0;c<a.length;c++)j.push(d(a[c]))},i.end=function(a){var c,d;if(l===a){for(0===k.length&&b(),d=k[k.length-1].arr,c=0;c<j.length;c++)if(j[c].id!==d)return b(),k;return k}return[]},i.length=function(){return j.length},i.size=i.length,i.lt=function(a,b){var d=c(a,b);return d[0].value<d[1].value},i.lte=function(a,b){var d=c(a,b);return d[0].value<=d[1].value},i.gt=function(a,b){var d=c(a,b);return d[0].value>d[1].value},i.gte=function(a,b){var d=c(a,b);return d[0].value>=d[1].value},i.eq=function(a,b){var d=c(a,b);return d[0].value===d[1].value},i.neq=function(a,b){var d=c(a,b);return d[0].value!==d[1].value},i.play=function(){h("play",arguments)},i.mark=function(){h("mark",arguments)},i.clearHighlight=function(){m.highlight=[]},i.highlight=function(){i.clearHighlight(),h("highlight",arguments)},i.get=function(a){return d(j[a])},i.swap=function(a,b){var c,d,e,g,i;i=h("swap",[a,b]),c=f(i[0]),d=f(i[1]),e=j[c],g=j[d],j[c]=g,j[d]=e,o++,k[k.length-1].swapCount=o},a.AS=i}(this),function(a){"use strict";a.AudioPlayer={},a.AudioPlayer.create=function(b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H={},I=!1,J=-1,K=-1,L=-1,M=-1;return v=function(){c=c||{},d=c.isLooping||!1,e=c.isPlaying||!1,f=c.isReverse||!1,h=c.hasMarkers||!1,i=c.allowHover||!1,j=c.allowClick||!1,k=c.onClick,"function"!=typeof k&&(k=$.noop),g=0,l=$(b||null),n=l.find(".position-count"),o=l.find(".swap-count"),m=l.find("svg"),q=d3.select("#"+m.attr("id")),F=c.onPlayerButtonClickCallback||null,t=timbre("perc",{a:50,r:2500}),u=timbre("PluckGen",{env:t,mul:AudioSort.getSelected("volume"),poly:10}).on("ended",function(){e||this.pause()}),s=timbre("interval",{interval:AudioSort.getSelected("tempo")},y),l.find(".player-buttons").on("click",".btn",E),i&&(m.on("mousemove",function(a){var b,c=C(a);J!==c.index&&(J=c.index,b=m.find("rect"),b.attr("opacity",1),b.eq(J).attr("opacity",.5)),K=c.value,!I||J===L&&K===M||(L=J,M=K,k(L,M))}),m.on("mouseout",function(){J=-1,m.find("rect").attr("opacity",1)})),j&&(m.on("mousedown",function(a){var b=C(a);a.preventDefault(),I=!0,L=b.index,M=b.value,k(L,M)}),m.on("mouseup",function(){I=!1,L=-1,M=-1}))},w=function(){var b;x(),b=a.viz.bar.draw(r,g),b&&(n.text(parseInt(g+1,10)+" / "+r.length),o.length&&o.text("c:"+b.compareCount+" / s:"+b.swapCount))},C=function(a){var b,c,d,e,f,h,i,j=$(a.currentTarget),k=j.parent(),l=0,m=0;return d=k.offset(),e=a.pageX-d.left,f=a.pageY-d.top,e-=parseInt(k.css("border-left-width"),10),e-=parseInt(k.css("margin-left"),10),e-=parseInt(k.css("padding-left"),10),f-=parseInt(k.css("border-top-width"),10),f-=parseInt(k.css("margin-top"),10),f-=parseInt(k.css("padding-top"),10),h=j.parent().width(),i=j.parent().height(),r.length>0&&(l=r[g].arr.length,m=l-1),b=Math.floor(e/h*l),c=Math.floor(f/i*l),b=isFinite(b)?b:0,c=isFinite(c)?c:0,b=Math.min(m,b),c=Math.min(m,c),c=m-c,{index:b,value:c}},D=function(){p.length&&p.slider("setValue",g)},x=function(){g=Math.min(g,r.length-1),g=Math.max(g,0)},z=function(a){var b,c,d,e,f,g,h;return b=sc.ScaleInfo.at(AudioSort.getSelected("scale")),c=b.pitchesPerOctave(),d=b.degrees(),e=d.length,f=Math.floor(AudioSort.getSelected("dataSize")/2),g=A(d,e,c,a),h=A(d,e,c,f),g+AudioSort.getSelected("centerNote")-h},A=function(a,b,c,d){return a[d%b]+Math.floor(d/b)*c},B=function(a){var b=[];return a.indices.length&&b.push(a.indices[0]),b},y=function(){var a,b,c,h;if(e){if(x(),D(),r.length>0){for(b=r[g],c=0;c<b.arr.length;c++)h=b.arr[c],h.play&&(a=z(h.value),a>=0&&128>a&&u.noteOn(a,64));w()}g=f?g-1:g+1,!d&&(0>g||g>=r.length)&&H.stop(),d&&0>g?g=r.length-1:d&&g>=r.length&&(g=0)}else H.stop()},E=function(){var a=$(this),b=a.data("action");"stop"===b?H.stop():"play"===b?H.play():"reverse"===b?H.play(!0):"goToFirst"===b?H.goToFirst():"goToLast"===b?H.goToLast():"loop"===b&&(d=!a.hasClass("active"),d?a.addClass("active"):a.removeClass("active")),D(),"function"==typeof F&&F({item:a,action:b})},G=function(a){g=parseInt(a.value,10),x(),w()},H.setData=function(a){var c=b+" .position-container";r=a,p=AudioSort.createSlider(c,{value:0,min:0,max:r.length-1,step:1},G),w()},H.setTempo=function(a){s.set({interval:a})},H.setVolume=function(a){u.set({mul:a})},H.play=function(a){s.stop(),e=!0,a===!0?(f=!0,0>=g&&(g=r.length-1)):(f=!1,g>=r.length-1&&(g=0)),f=a===!0?!0:!1,u.play(),s.start()},H.stop=function(){e=!1,s.stop()},H.isPlaying=function(){return e},H.goToFirst=function(){g=0,x(),w()},H.goToLast=function(){g=r.length-1,x(),w()},v(),H}}(this),function(a){"use strict";var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F={},G=Function,H={volume:{value:.25,min:0,max:1,step:.01},tempo:{value:120,min:20,max:300,step:1},centerNote:{value:69,min:0,max:127,step:1},scale:{value:"chromatic"},sort:{value:"bubble"},dataSize:{value:25,min:4,max:48,step:1}},I={volume:H.volume.value,tempo:H.tempo.value,centerNote:H.centerNote.value,scale:H.scale.value,sort:H.sort.value,dataSize:H.dataSize.value},J={base:null,sort:null},K={},L=[],M=[],N=null,O=250,P=null,Q="dist/worker.min.js";k=function(b){var c,d,e,f,g;if(a.hasOwnProperty("sort")){c=$(b),c.empty();for(f in a.sort)a.sort.hasOwnProperty(f)&&(g=a.sort[f],d=$("<li></li>"),e=$('<a href="javascript:void(0);"></a>'),e.attr("data-sort",f),e.text(g.display),d.append(e),c.append(d))}},o=function(a){var b,c=[];for(b=0;b<L.length;b++)c.push({value:L[b],play:b===a,mark:!1,swap:!1,justSwapped:!1,compare:!1,highlight:!1});return c},n=function(){var a,b=[];for(a=0;a<L.length;a++)b.push({arr:o(a),compareCount:0,swapCount:0});return b},l=function(){$('#sort-player .btn[data-action="play"]').click()},p=function(a){var b=["c","c#","d","d#","e","f","f#","g","g#","a","a#","b"],c=b.length,d=Math.floor(a/c)-1,e=a%c,f=b[e];return"("+f.charAt(0)+d+f.charAt(1)+") "+a},E=function(a,b,c){K.hasOwnProperty(a)||(K[a]=$(a)),"function"==typeof c&&(b=c(b)),K[a].text(b)},u=function(a,b,c,d){c&&(I[a]=c.value),E(b,I[a],d)},y=function(a){u("volume","#volume-display",a,function(a){return a.toFixed(2)}),J.base.setVolume(I.volume),J.sort.setVolume(I.volume)},x=function(a){var b=r();u("tempo","#tempo-display",a),J.base.setTempo(b),J.sort.setTempo(b)},v=function(a){u("centerNote","#center-note-display",a,p)},w=function(a){u("dataSize","#data-size-display",a),L=M.slice(0,I.dataSize),J.base.setData(n()),m()},t=function(a){I.scale=a.target.value},s=function(){var b=$(this).data("action");a.fn.datagen.hasOwnProperty(b)&&(L=a.fn.datagen[b](I.dataSize),J.base.setData(n()),m())},z=function(){var a=$(this),b=a.parent();a.hasClass("disabled")||(b.find("li").removeClass("active"),a.addClass("active"),E("#sort-display",a.text()),I.sort=a.find("a").data("sort"),m())},h=function(a){var b=$(a),c="id_"+(new Date).getTime();b.empty().append('<div class="js-editor" id="'+c+'"></div>'),d=ace.edit(c),d.setTheme("ace/theme/monokai"),d.getSession().setMode("ace/mode/javascript"),d.getSession().on("changeAnnotation",function(){var a,b,c=d.getSession().getAnnotations(),e=[],f=!1;for(a=0;a<c.length;a++)b=c[a],"'AS' is not defined."===b.text?f=!0:e.push(b);f&&d.getSession().setAnnotations(e)})},A=function(){var b,c,e=$("#sort-modal"),f=a.sort[I.sort];e.find(".sort-name").text(f.display),e.find(".nav-tabs a:first").tab("show"),e.find("#sort-info-display").html(f.display||"&nbsp;"),e.find("#sort-info-stable").html(f.stable?"Yes":"No"),e.find("#sort-info-best").html(f.best||"&nbsp;"),e.find("#sort-info-average").html(f.average||"&nbsp;"),e.find("#sort-info-worst").html(f.worst||"&nbsp;"),e.find("#sort-info-memory").html(f.memory||"&nbsp;"),e.find("#sort-info-method").html(f.method||"&nbsp;"),h("#sort-algorithm"),b=$.trim(f.toString()).split("\n"),c=b.splice(1,b.length-2).join("\n"),c=js_beautify(c,{indent_size:1,indent_char:"	"}),d.setValue(c),d.clearSelection(),e.modal()},i=function(){a.sort[I.sort]=new G(d.getValue()),$("#sort-modal").modal("hide")},j=function(){var b=$("#new-sort-name").val(),c=b.replace(/[^a-zA-Z]/gi,""),e=c+"_id_"+(new Date).getTime();$.trim(b).length&&(a.sort[e]=new G(d.getValue()),a.sort[e].display=b,a.sort[e].stable=!0,a.sort[e].best="",a.sort[e].average="",a.sort[e].worst="",a.sort[e].memory="",a.sort[e].method=""),$("#add-algorithm-modal").modal("hide"),k("#sort-options")},B=function(){var a=$("#add-algorithm-modal");a.find("#new-sort-name").val(""),h("#new-sort-algorithm"),a.modal()},r=function(){return"bpm"+(parseFloat(I.tempo)||120)+" l16"},D=function(){J.base=AudioPlayer.create("#base-section",{env:b,pluck:c,isLooping:!0,hasMarkers:!1,allowHover:!0,allowClick:!0,onClick:function(a,b){L[a]=b,J.base.setData(n()),clearTimeout(N),N=setTimeout(m,O)},onPlayerButtonClickCallback:function(a){"loop"!==a.action&&J.sort.stop()}}),J.sort=AudioPlayer.create("#sort-section",{env:b,pluck:c,isLooping:!1,hasMarkers:!0,onPlayerButtonClickCallback:function(a){"loop"!==a.action&&J.base.stop()}})},q=function(){var a=sc.ScaleInfo.names().sort(function(a,b){var c=0,d=sc.ScaleInfo.at(a),e=sc.ScaleInfo.at(b);return c=d.pitchesPerOctave()-e.pitchesPerOctave(),0===c&&(c=d.degrees().length-e.degrees().length,0===c&&(c=d.name.localeCompare(e.name))),c});return a},C=function(a,b,c){var d,e,f,g,h,i,j,k,l;j=$(a),g=q(),$.each(g,function(a,b){f=sc.ScaleInfo.at(b),h=f.pitchesPerOctave(),i=f.degrees().length,d=h+"_"+i,d!==e&&(e&&j.append(k),e=d,k=$("<optgroup />").attr("label","Octave: "+h+" / Notes: "+i)),l=$("<option />").val(b).text(f.name),I.scale===b&&l.attr("selected","selected"),k.append(l)}),j.append(k),$(a).chosen().change(c),$(b).width("100%")},f=function(a){var b=J.sort.isPlaying();a.data.key===e&&(J.sort.setData(a.data.frames||[]),J.sort.goToFirst(),b&&l())},g=function(a){console.log(a)},m=function(){"undefined"!=typeof Worker&&(null!==P&&(P.removeEventListener("message",f,!1),P.removeEventListener("error",g,!1),P.terminate()),e=(new Date).getTime(),P=new Worker(Q),P.addEventListener("message",f,!1),P.addEventListener("error",g,!1),P.postMessage({key:e,fn:a.sort[I.sort].toString(),arr:L}))},F.createSlider=function(a,b,c){var d,e=$(a),f=$('<div class="audio-sort-slider"></div>');return e.empty(),f.appendTo(e),d=f.slider({value:b.value,min:b.min,max:b.max,step:b.step,orientation:"horizontal",selection:"none",tooltip:"hide"}),d.on("slide",c),d.on("slideStop",c),$(a+" .slider").width("100%"),d},F.getSelected=function(a,b){return I.hasOwnProperty(a)?I[a]:b},F.init=function(b){"string"==typeof b&&(Q=b),k("#sort-options"),D(),L=a.fn.datagen.randomUnique(I.dataSize),M=a.fn.datagen.sorted(H.dataSize.max),J.base.setData(n()),C("#scale-select","#scale_select_chzn",t),F.createSlider("#volume-container",H.volume,y),F.createSlider("#tempo-container",H.tempo,x),F.createSlider("#center-note-container",H.centerNote,v),F.createSlider("#data-size-container",H.dataSize,w),$("#sort-modal-open").on("click",A),$("#add-algorithm-btn").on("click",B),$("#save-algorithm-edit").on("click",i),$("#save-algorithm-new").on("click",j),$("#base-buttons").on("click",".btn",s),$("#sort-options").on("click","li",z),$("#sort-options [data-sort="+I.sort+"]").click(),E("#volume-display",I.volume),E("#tempo-display",I.tempo),E("#center-note-display",I.centerNote,p),E("#data-size-display",I.dataSize)},a.AudioSort=F}(this);